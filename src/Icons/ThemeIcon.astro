<div class="flex">
  <button id="themeToggle" class="mr-4 dark:text-white">
    <svg
      xmlns="http://www.w3.org/2000/svg"
      width="28"
      height="28"
      viewBox="0 0 24 24"
      fill="none"
      stroke="currentColor"
      stroke-width="2"
      stroke-linecap="round"
      stroke-linejoin="round"
      class="icon icon-tabler icons-tabler-outline icon-tabler-brightness-up"
      ><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path
        d="M12 12m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0"></path><path d="M12 5l0 -2"
      ></path><path d="M17 7l1.4 -1.4"></path><path d="M19 12l2 0"></path><path
        d="M17 17l1.4 1.4"></path><path d="M12 19l0 2"></path><path
        d="M7 17l-1.4 1.4"></path><path d="M6 12l-2 0"></path><path
        d="M7 7l-1.4 -1.4"></path></svg
    >
  </button>
</div>

<script is:inline>
  const THEMES = {
    LIGHT: 'light',
    DARK: 'dark',
  }

  const getCurrentTheme = () => {
    if (typeof localStorage !== 'undefined') {
      const storedTheme = localStorage.getItem('theme')

      if (storedTheme) return storedTheme
    }

    return window.matchMedia('(prefers-color-scheme: dark)').matches
      ? THEMES.DARK
      : THEMES.LIGHT
  }

  const applyTheme = theme => {
    const method = theme === THEMES.DARK ? 'add' : 'remove'

    document.documentElement.classList[method]('dark')
  }

  const toggleTheme = () => {
    const currentTheme = getCurrentTheme()
    const newTheme = currentTheme === THEMES.DARK ? THEMES.LIGHT : THEMES.DARK

    localStorage.setItem('theme', newTheme)

    applyTheme(newTheme)
  }

  const initialTheme = getCurrentTheme()
  applyTheme(initialTheme)

  document.getElementById('themeToggle').addEventListener('click', toggleTheme)
</script>
